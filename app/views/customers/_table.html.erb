<style>
  .customer-company {
    min-width: 200px;
  }
  .customer-address {
    min-width: 300px;
  }
  .customers-table {
    min-height: 300px;
  }
</style>

<div class='mb-4 customers-table table-responsive'>
  <table class='table table-bordered table-striped table-hover'>
    <thead class='thead-light'>
      <tr>
        <th colspan='2' class='text-center'>Personal Information</th>
        <th class='text-center'>Address</th>
        <th colspan='2' class='text-center'>Contact Information</th>
        <th colspan='3' class='text-center'>Other Information</th>
        <th></th>
      </tr>
      <tr>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'first_name') %>
        </th>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'last_name') %>
        </th>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'address') %>
        </th>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'phone') %>
        </th>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'email') %>
        </th>
        <th class='text-nowrap'>
          <%= build_sort_link('customer', 'support_rep') %>
        </th>
        <th class='text-nowrap'>Invoices Count</th>
        <th class='text-nowrap'>Company/Timestamp</th>
        <th class='text-center'>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @customers.each do |customer| %>
        <tr>
          <td><%= link_to customer.first_name, customer %></td>
          <td><%= link_to customer.last_name, customer %></td>

          <td class='customer-address'>
            <div class='dropdown'>
              <button class='btn btn-link text-dark btn-sm dropdown-toggle text-decoration-none px-0'
                type='button' id='dropdownAddress<%= customer.id %>'
                data-bs-toggle='dropdown' aria-expanded='false' data-bs-auto-close='outside'>
                <%= customer.address %>
              </button>
              <ul class='dropdown-menu' aria-labelledby='dropdownAddress<%= customer.id %>'>
                <li class='px-3'><strong>State:</strong> <%= customer.state %></li>
                <li class='px-3'><strong>City:</strong> <%= customer.city %></li>
                <li class='px-3'><strong>Country:</strong> <%= customer.country %></li>
                <li class='px-3'><strong>Postal Code:</strong> <%= customer.postal_code %></li>
                <li class='px-3'><strong>Address:</strong> <%= customer.address %></li>
              </ul>
            </div>
          </td>

          <td>
            <div class='dropdown'>
              <button class='btn btn-link text-dark btn-sm dropdown-toggle text-decoration-none px-0'
                type='button' id='dropdownPhone<%= customer.id %>'
                data-bs-toggle='dropdown' aria-expanded='false' data-bs-auto-close='outside'>
                <%= customer.phone %>
              </button>
              <ul class='dropdown-menu' aria-labelledby='dropdownPhone<%= customer.id %>'>
                <li class='px-3 text-nowrap'><strong>Fax:</strong> <%= customer.fax %></li>
                <li class='px-3 text-nowrap'><strong>Phone:</strong> <%= customer.phone %></li>
              </ul>
            </div>
          </td>
          <td><%= customer.email %></td>
          <td class='text-nowrap'><%= customer.support_rep&.full_name %></td>
          <td class='text-nowrap'><%= link_to customer.invoices_count, customer %></td>
          <td>
            <div class='dropdown'>
              <button class='btn btn-link text-dark btn-sm dropdown-toggle text-decoration-none px-0'
                type='button' id='dropdownOtherInfo<%= customer.id %>'
                data-bs-toggle='dropdown' aria-expanded='false' data-bs-auto-close='outside'>
                Company: <%= customer.company %>
              </button>
              <ul class='dropdown-menu' aria-labelledby='dropdownOtherInfo<%= customer.id %>'>
                <li class='px-3 text-nowrap'><strong>Company:</strong> <%= customer.company %></li>
                <li class='px-3 text-nowrap'><strong>Created At:</strong> <%= customer.created_at %></li>
                <li class='px-3 text-nowrap'><strong>Updated At:</strong> <%= customer.updated_at %></li>
                <li class='px-3 text-nowrap'><strong><%= link_to 'View customer', customer %></strong></li>
              </ul>
            </div>
          </td>

          <td class='text-center'>
            <div class='dropdown'>
              <button class='btn btn-secondary btn-sm dropdown-toggle'
                type='button' id='dropdownActions<%= customer.id %>'
                data-bs-toggle='dropdown' aria-expanded='false'>
                Actions
              </button>
              <ul class='dropdown-menu' aria-labelledby='dropdownActions<%= customer.id %>'>
                <li>
                  <%= link_to customer, class: 'dropdown-item' do %>
                    <i class='bi bi-eye'></i> View
                  <% end %>
                </li>
                <li>
                  <%= link_to edit_customer_path(customer), class: 'dropdown-item text-warning' do %>
                    <i class='bi bi-pencil'></i> Edit
                  <% end %>
                </li>
                <li>
                  <%= link_to customer, method: :delete,
                    data: { turbo_method: 'delete', turbo_confirm: 'Are you sure?' },
                    class: 'dropdown-item text-danger' do %>
                    <i class='bi bi-trash'></i> Delete
                  <% end %>
                </li>
              </ul>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
